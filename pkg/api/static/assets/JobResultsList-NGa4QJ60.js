import{Q as f,r as c,j as e,T as h,H as p}from"./index-58sC-F_I.js";import{G as y,d as C,a as v,b as P,C as R,c as S,e as w}from"./KeyboardArrowRight-C0HdunLo.js";import{u as I,L}from"./Loading-JYPjAprI.js";import{A as k,J as z,T as g,a as J,b as W,d as _,O as d,I as j}from"./AppContext-ZyWevVPL.js";import{a as F,S as $}from"./Stack-QMmcjyoG.js";const A="[listJobResultsQueryKey]",T=(s,i,a)=>{const n=i||10,l=a||0;return I({queryKey:[A,n,l],queryFn:()=>fetch(`http://localhost:8080/v1/jobs/${s}?limit=${n}&offset=${l}`).then(o=>o.json())})},B={ok:"success",error:"danger"},E=s=>{if(s==="ok")return e.jsx(S,{color:"success"});if(s=="error")return e.jsx(w,{color:"error"})},N=({lastStatus:s})=>e.jsx(e.Fragment,{children:e.jsx(R,{variant:"soft",size:"lg",startDecorator:E(s),children:e.jsx(h,{color:B[s],children:s})})}),q=({id:s,jobId:i,endpoint:a,method:n,succeeded:l,lastStatusCode:o,lastResponseAt:x})=>e.jsxs("tr",{style:{width:"100%"},children:[e.jsx("td",{children:e.jsx(g,{sx:{zIndex:9999999999},title:s,variant:"outlined",children:e.jsxs("span",{children:[s.substring(0,5),"..."]})})}),e.jsx("td",{children:e.jsx(g,{sx:{zIndex:9999999999},title:i,variant:"outlined",children:e.jsxs("span",{children:[i.substring(0,5),"..."]})})}),e.jsx("td",{children:e.jsx(g,{title:a,variant:"outlined",children:e.jsxs("span",{children:[a.substring(0,20),"..."]})})}),e.jsx("td",{children:n}),e.jsx("td",{children:e.jsx(N,{lastStatus:l})}),e.jsx("td",{children:o}),e.jsx("td",{children:new Date(x).toLocaleString()})]}),H=()=>e.jsxs("tr",{children:[e.jsx("th",{style:{width:80,minWidth:80,padding:"12px 6px"},children:"Id"}),e.jsx("th",{style:{width:80,minWidth:80,padding:"12px 6px"},children:"Job Id"}),e.jsx("th",{style:{minWidth:180,padding:"12px 6px"},children:"Endpoint"}),e.jsx("th",{style:{width:80,minWidth:80,padding:"12px 6px"},children:"Method"}),e.jsx("th",{style:{minWidth:140,padding:"12px 6px"},children:"Succeeded"}),e.jsx("th",{style:{minWidth:140,padding:"12px 6px"},children:"Last Status Code"}),e.jsx("th",{style:{minWidth:140,padding:"12px 6px"},children:"Response At"})]}),Q=s=>e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:e.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:2,justifyContent:"flex-end"},children:[e.jsxs(J,{orientation:"horizontal",size:"sm",children:[e.jsx(W,{children:"Rows per page:"}),e.jsxs(_,{onChange:s.handleChangeRowsPerPage,value:s.rowsPerPage,children:[e.jsx(d,{value:5,children:"5"}),e.jsx(d,{value:10,children:"10"}),e.jsx(d,{value:25,children:"25"}),e.jsx(d,{value:50,children:"50"}),e.jsx(d,{value:100,children:"100"})]})]}),e.jsxs(p,{sx:{display:"flex",gap:1},children:[e.jsx(j,{size:"sm",color:"neutral",variant:"outlined",disabled:s.page===0,onClick:()=>s.handleChangePage(0),sx:{bgcolor:"background.surface"},children:e.jsx(C,{})}),e.jsx(j,{size:"sm",color:"neutral",variant:"outlined",disabled:s.page===0,onClick:()=>s.handleChangePage(s.page-1),sx:{bgcolor:"background.surface"},children:e.jsx(v,{})}),e.jsx(j,{size:"sm",color:"neutral",variant:"outlined",disabled:s.currentPageLength<s.rowsPerPage,onClick:()=>s.handleChangePage(s.page+1),sx:{bgcolor:"background.surface"},children:e.jsx(P,{})})]})]})})})}),U=()=>{const s=f(),i=c.useContext(k),a=c.useMemo(()=>{const t=s.pathname.split("/");return t[t.length-1]},[s.pathname]),[n,l]=c.useState(10),[o,x]=c.useState(0),{data:r,error:m,isLoading:b}=T(a,n,o*n);return e.jsx(e.Fragment,{children:e.jsxs(F,{spacing:4,children:[e.jsx(h,{style:{marginBottom:"1rem"},level:"h1",children:"Executions"}),e.jsx(h,{style:{marginBottom:"1rem"},level:"title-lg",children:i[z].jobName}),!!m&&e.jsx($,{style:{minWidth:"20rem",minHeight:"20rem",display:"flex",alignItems:"center",justifyContent:"center"},color:"danger",variant:"soft",children:e.jsx(h,{color:"danger",level:"body-lg",children:"Couldn't query Job Results"})}),b&&e.jsx(L,{}),r&&e.jsx(y,{title:"Registered Jobs",Headers:H,Rows:(r==null?void 0:r.jobResults.map((t,u)=>e.jsx(q,{id:t.id,jobId:t.jobId,endpoint:t.endpoint,method:t.httpmethod,succeeded:t.succeeded,lastStatusCode:t.lastStatusCode,lastResponseAt:t.lastResponseAt},u)))||[],Foot:e.jsx(Q,{page:o,rowsPerPage:n,handleChangePage:t=>{x(t)},handleChangeRowsPerPage:(t,u)=>{l(parseInt(u.toString(),10))},currentPageLength:(r==null?void 0:r.jobResults)||0})})]})})};export{U as default};
