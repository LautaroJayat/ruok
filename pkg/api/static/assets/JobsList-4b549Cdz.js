import{x as ie,y as le,s as k,a as l,r as u,k as ce,l as z,K as T,L as de,M as ue,N as xe,c as he,m as y,j as e,t as pe,v as C,w as ge,C as ve,D as me,T as f,H as E}from"./index-58sC-F_I.js";import{G as fe,d as je,a as be,b as ye,C as Ce,c as De,e as ke}from"./KeyboardArrowRight-C0HdunLo.js";import{u as Pe,L as $e}from"./Loading-JYPjAprI.js";import{A as Re,T as J,a as _e,b as Le,d as Ie,O as v,I as D,J as S}from"./AppContext-ZyWevVPL.js";import{a as Fe,S as ze}from"./Stack-QMmcjyoG.js";function Te(t){return le("MuiLink",t)}const Ee=ie("MuiLink",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","variantPlain","variantOutlined","variantSoft","variantSolid","underlineNone","underlineHover","underlineAlways","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","startDecorator","endDecorator"]),N=Ee,Je=["color","textColor","variant"],Se=["children","disabled","onBlur","onFocus","level","overlay","underline","endDecorator","startDecorator","component","slots","slotProps"],Ne=t=>{const{level:r,color:n,variant:s,underline:i,focusVisible:a,disabled:c}=t,d={root:["root",n&&`color${C(n)}`,c&&"disabled",a&&"focusVisible",r,i&&`underline${C(i)}`,s&&`variant${C(s)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return ge(d,Te,{})},we=k("span",{name:"JoyLink",slot:"StartDecorator",overridesResolver:(t,r)=>r.startDecorator})(({ownerState:t})=>{var r;return l({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Link-gap, 0.375em), 0.75rem)"},typeof t.startDecorator!="string"&&(t.alignItems==="flex-start"||((r=t.sx)==null?void 0:r.alignItems)==="flex-start")&&{marginTop:"2px"})}),Ae=k("span",{name:"JoyLink",slot:"endDecorator",overridesResolver:(t,r)=>r.endDecorator})(({ownerState:t})=>{var r;return l({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Link-gap, 0.25em), 0.5rem)"},typeof t.startDecorator!="string"&&(t.alignItems==="flex-start"||((r=t.sx)==null?void 0:r.alignItems)==="flex-start")&&{marginTop:"2px"})}),Be=k("a",{name:"JoyLink",slot:"Root",overridesResolver:(t,r)=>r.root})(({theme:t,ownerState:r})=>{var n,s,i,a,c,d,o;return[l({"--Icon-fontSize":"1.25em","--Icon-color":"currentColor","--CircularProgress-size":"1.25em","--CircularProgress-thickness":"3px"},r.level&&r.level!=="inherit"&&t.typography[r.level],r.level==="inherit"&&{font:"inherit"},r.underline==="none"&&{textDecoration:"none"},r.underline==="hover"&&{textDecoration:"none","&:hover":{"@media (hover: hover)":{textDecorationLine:"underline"}}},r.underline==="always"&&{textDecoration:"underline"},r.startDecorator&&{verticalAlign:"bottom"},{textDecorationThickness:"max(0.08em, 1px)",textUnderlineOffset:"0.15em",display:"inline-flex",alignItems:"center",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:t.vars.radius.xs,padding:0,cursor:"pointer",textDecorationColor:`var(--variant-outlinedBorder, rgba(${(n=t.vars.palette[r.color])==null?void 0:n.mainChannel} / var(--Link-underlineOpacity, 0.72)))`},r.variant?l({paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!r.nesting&&{marginInline:"-0.25em"}):{color:`var(--variant-plainColor, rgba(${(s=t.vars.palette[r.color])==null?void 0:s.mainChannel} / 1))`,[`&.${N.disabled}`]:{pointerEvents:"none",color:`var(--variant-plainDisabledColor, rgba(${(i=t.vars.palette[r.color])==null?void 0:i.mainChannel} / 0.6))`}},{userSelect:r.component==="button"?"none":void 0,MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"}},r.overlay?{position:"initial","&::after":{content:'""',display:"block",position:"absolute",top:0,left:0,bottom:0,right:0,borderRadius:"var(--unstable_actionRadius, inherit)",margin:"var(--unstable_actionMargin)"},[`${t.focus.selector}`]:{"&::after":t.focus.default}}:{position:"relative",[t.focus.selector]:t.focus.default}),r.variant&&l({},(a=t.variants[r.variant])==null?void 0:a[r.color],{"&:hover":{"@media (hover: hover)":(c=t.variants[`${r.variant}Hover`])==null?void 0:c[r.color]},"&:active":(d=t.variants[`${r.variant}Active`])==null?void 0:d[r.color],[`&.${N.disabled}`]:(o=t.variants[`${r.variant}Disabled`])==null?void 0:o[r.color]})]}),Ve=u.forwardRef(function(r,n){const s=ce({props:r,name:"JoyLink"}),{color:i="primary",textColor:a,variant:c}=s,d=z(s,Je),o=u.useContext(T),x=u.useContext(de),p=ue(l({},d,{color:a})),{children:h,disabled:A=!1,onBlur:$,onFocus:R,level:B="body-md",overlay:V=!1,underline:M="hover",endDecorator:_,startDecorator:L,component:O,slots:W={},slotProps:q={}}=p,H=z(p,Se),U=o||x?r.level||"inherit":B,{isFocusVisibleRef:I,onBlur:K,onFocus:G,ref:Q}=xe(),[X,F]=u.useState(!1),Y=he(n,Q),Z=g=>{K(g),I.current===!1&&F(!1),$&&$(g)},ee=g=>{G(g),I.current===!0&&F(!0),R&&R(g)},m=l({},p,{color:i,disabled:A,focusVisible:X,underline:M,variant:c,level:U,overlay:V,nesting:o}),j=Ne(m),b=l({},H,{component:O,slots:W,slotProps:q}),[te,re]=y("root",{additionalProps:{onBlur:Z,onFocus:ee},ref:Y,className:j.root,elementType:Be,externalForwardedProps:b,ownerState:m}),[oe,ne]=y("startDecorator",{className:j.startDecorator,elementType:we,externalForwardedProps:b,ownerState:m}),[se,ae]=y("endDecorator",{className:j.endDecorator,elementType:Ae,externalForwardedProps:b,ownerState:m});return e.jsx(T.Provider,{value:!0,children:e.jsxs(te,l({},re,{children:[L&&e.jsx(oe,l({},ne,{children:L})),pe(h,["Skeleton"])?u.cloneElement(h,{variant:h.props.variant||"inline"}):h,_&&e.jsx(se,l({},ae,{children:_}))]}))})}),Me=Ve,Oe="[listJobsQueryKey]",We=(t,r)=>{const n=t||10,s=r||0;return Pe({queryKey:[Oe,n,s],queryFn:()=>fetch(`http://localhost:8080/v1/jobs?limit=${n}&offset=${s}`).then(i=>i.json())})};var P={},qe=me;Object.defineProperty(P,"__esModule",{value:!0});var w=P.default=void 0,He=qe(ve()),Ue=e,Ke=(0,He.default)((0,Ue.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");w=P.default=Ke;const Ge={ok:e.jsx(De,{}),error:e.jsx(ke,{})},Qe={ok:"success",error:"danger"},Xe=({lastStatus:t})=>e.jsx(e.Fragment,{children:e.jsx(Ce,{variant:"soft",size:"lg",startDecorator:Ge[t],children:e.jsx(f,{color:Qe[t],children:t})})}),Ye=({id:t,name:r,endpoint:n,method:s,expression:i,lastExecution:a,lastStatus:c,createdAt:d,handleOnClick:o})=>{const[x]=u.useState(n.split("/"));return e.jsxs("tr",{style:{width:"100%"},children:[e.jsx("td",{children:e.jsx(J,{sx:{zIndex:9999999999},title:t,variant:"outlined",children:e.jsxs("span",{children:[" ",t.substring(0,5),"..."]})})}),e.jsx("td",{children:r}),e.jsx("td",{children:e.jsx(J,{title:n,variant:"outlined",children:e.jsx("span",{children:x.map((p,h)=>e.jsxs(e.Fragment,{children:[e.jsx("wbr",{}),p,h!==x.length-1&&"/"]}))})})}),e.jsx("td",{children:s}),e.jsx("td",{children:i}),e.jsx("td",{children:new Date(a).toLocaleString()}),e.jsx("td",{children:e.jsx(Xe,{lastStatus:c})}),e.jsx("td",{children:new Date(d).toLocaleString()}),e.jsx("td",{children:e.jsx(Me,{onClick:()=>o(t,r),href:`#/jobs/${t}`,children:e.jsx(w,{})})})]})},Ze=()=>e.jsxs("tr",{children:[e.jsx("th",{style:{width:80,minWidth:80,padding:"12px 6px"},children:"Job Id"}),e.jsx("th",{style:{width:80,padding:"12px 6px"},children:"Name"}),e.jsx("th",{style:{width:150,padding:"12px 6px"},children:"Endpoint"}),e.jsx("th",{style:{width:80,padding:"12px 6px"},children:"Method"}),e.jsx("th",{style:{width:100,padding:"12px 6px"},children:"CronExpression"}),e.jsx("th",{style:{width:140,padding:"12px 6px"},children:"Last Execution"}),e.jsx("th",{style:{width:80,padding:"12px 6px"},children:"Last Status"}),e.jsx("th",{style:{width:140,padding:"12px 6px"},children:"Created At"}),e.jsx("th",{style:{width:50,padding:"12px 6px"}})]}),et=t=>e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:e.jsxs(E,{sx:{display:"flex",alignItems:"center",gap:2,justifyContent:"flex-end"},children:[e.jsxs(_e,{orientation:"horizontal",size:"sm",children:[e.jsx(Le,{children:"Rows per page:"}),e.jsxs(Ie,{onChange:t.handleChangeRowsPerPage,value:t.rowsPerPage,children:[e.jsx(v,{value:5,children:"5"}),e.jsx(v,{value:10,children:"10"}),e.jsx(v,{value:25,children:"25"}),e.jsx(v,{value:50,children:"50"}),e.jsx(v,{value:100,children:"100"})]})]}),e.jsxs(f,{textAlign:"center",sx:{minWidth:80},children:[t.page*t.rowsPerPage+1," to"," ",Math.min(t.page*t.rowsPerPage+t.rowsPerPage,t.totalRows)," of ",t.totalRows]}),e.jsxs(E,{sx:{display:"flex",gap:1},children:[e.jsx(D,{size:"sm",color:"neutral",variant:"outlined",disabled:t.page===0,onClick:()=>t.handleChangePage(0),sx:{bgcolor:"background.surface"},children:e.jsx(je,{})}),e.jsx(D,{size:"sm",color:"neutral",variant:"outlined",disabled:t.page===0,onClick:()=>t.handleChangePage(t.page-1),sx:{bgcolor:"background.surface"},children:e.jsx(be,{})}),e.jsx(D,{size:"sm",color:"neutral",variant:"outlined",disabled:t.totalRows!==-1?t.totalRows<=(t.page+1)*t.rowsPerPage:!1,onClick:()=>t.handleChangePage(t.page+1),sx:{bgcolor:"background.surface"},children:e.jsx(ye,{})})]})]})})})}),tt=t=>(r,n)=>{t[S].jobId=r,t[S].jobName=n},it=()=>{const t=u.useContext(Re),[r,n]=u.useState(10),[s,i]=u.useState(0),{data:a,error:c,isLoading:d}=We(r,s*r);return e.jsx(e.Fragment,{children:e.jsxs(Fe,{spacing:4,children:[e.jsx(f,{style:{marginBottom:"1rem"},level:"h1",children:"Registered Jobs"}),!!c&&e.jsx(ze,{style:{minWidth:"20rem",minHeight:"20rem",display:"flex",alignItems:"center",justifyContent:"center"},color:"danger",variant:"soft",children:e.jsx(f,{color:"danger",level:"body-lg",children:"Couldn't query Jobs"})}),d&&e.jsx($e,{}),a&&e.jsx(fe,{title:"Registered Jobs",Headers:Ze,Rows:(a==null?void 0:a.jobs.map((o,x)=>e.jsx(Ye,{id:o.id,name:o.name,endpoint:o.endpoint,method:o.httpmethod,expression:o.cronexp,lastExecution:o.lastExecution,lastStatus:o.succeeded,createdAt:o.createdAt,handleOnClick:tt(t)},x)))||[],Foot:e.jsx(et,{page:s,rowsPerPage:r,handleChangePage:o=>{i(o)},handleChangeRowsPerPage:(o,x)=>{n(parseInt(x.toString(),10))},totalRows:a.claimedJobs})})]})})};export{it as default};
