import{Q as m,r as h,j as e,T as u,H as g}from"./index-sTOYqK-X.js";import{G as f,d as b,a as y,b as C,C as P,c as v,e as R}from"./KeyboardArrowRight-JNptQ9Lg.js";import{u as S,L as w}from"./Loading-IiiUSp1k.js";import{a as L,S as k}from"./Stack-_5Q7gt6S.js";import{T as I,a as z,b as W,d as _,O as d,I as x}from"./Tooltip-InDb1DZE.js";const F="[listJobResultsQueryKey]",$=(s,l,r)=>{const i=l||10,a=r||0;return S({queryKey:[F,i,a],queryFn:()=>fetch(`http://localhost:8080/v1/jobs/${s}?limit=${i}&offset=${a}`).then(o=>o.json())})},J={ok:"success",error:"danger"},T=s=>{if(s==="ok")return e.jsx(v,{color:"success"});if(s=="error")return e.jsx(R,{color:"error"})},E=({lastStatus:s})=>e.jsx(e.Fragment,{children:e.jsx(P,{variant:"soft",size:"lg",startDecorator:T(s),children:e.jsx(u,{color:J[s],children:s})})}),q=({id:s,jobId:l,endpoint:r,method:i,succeeded:a,lastStatusCode:o,lastResponseAt:n})=>e.jsxs("tr",{style:{width:"100%"},children:[e.jsx("td",{children:s}),e.jsx("td",{children:l}),e.jsx("td",{children:e.jsx(I,{title:r,variant:"outlined",children:e.jsxs("span",{children:[r.substring(0,20),"..."]})})}),e.jsx("td",{children:i}),e.jsx("td",{children:e.jsx(E,{lastStatus:a})}),e.jsx("td",{children:o}),e.jsx("td",{children:new Date(n).toLocaleString()})]}),A=()=>e.jsxs("tr",{children:[e.jsx("th",{style:{width:80,minWidth:80,padding:"12px 6px"},children:"Id"}),e.jsx("th",{style:{width:50,minWidth:50,padding:"12px 6px"},children:"Job Id"}),e.jsx("th",{style:{minWidth:180,padding:"12px 6px"},children:"Endpoint"}),e.jsx("th",{style:{width:80,minWidth:80,padding:"12px 6px"},children:"Method"}),e.jsx("th",{style:{minWidth:140,padding:"12px 6px"},children:"Succeeded"}),e.jsx("th",{style:{minWidth:140,padding:"12px 6px"},children:"Last Status Code"}),e.jsx("th",{style:{minWidth:140,padding:"12px 6px"},children:"Response At"})]}),B=s=>e.jsx("thead",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:2,justifyContent:"flex-end"},children:[e.jsxs(z,{orientation:"horizontal",size:"sm",children:[e.jsx(W,{children:"Rows per page:"}),e.jsxs(_,{onChange:s.handleChangeRowsPerPage,value:s.rowsPerPage,children:[e.jsx(d,{value:5,children:"5"}),e.jsx(d,{value:10,children:"10"}),e.jsx(d,{value:25,children:"25"}),e.jsx(d,{value:50,children:"50"}),e.jsx(d,{value:100,children:"100"})]})]}),e.jsxs(g,{sx:{display:"flex",gap:1},children:[e.jsx(x,{size:"sm",color:"neutral",variant:"outlined",disabled:s.page===0,onClick:()=>s.handleChangePage(0),sx:{bgcolor:"background.surface"},children:e.jsx(b,{})}),e.jsx(x,{size:"sm",color:"neutral",variant:"outlined",disabled:s.page===0,onClick:()=>s.handleChangePage(s.page-1),sx:{bgcolor:"background.surface"},children:e.jsx(y,{})}),e.jsx(x,{size:"sm",color:"neutral",variant:"outlined",disabled:s.currentPageLength<s.rowsPerPage,onClick:()=>s.handleChangePage(s.page+1),sx:{bgcolor:"background.surface"},children:e.jsx(C,{})})]})]})})})}),M=()=>{const s=m(),l=h.useMemo(()=>{const t=s.pathname.split("/");return t[t.length-1]},[s.pathname]),[r,i]=h.useState(10),[a,o]=h.useState(0),{data:n,error:j,isLoading:p}=$(l,r,a*r);return e.jsx(e.Fragment,{children:e.jsxs(L,{spacing:4,children:[e.jsx(u,{style:{marginBottom:"1rem"},level:"h1",children:"Executions"}),!!j&&e.jsx(k,{style:{minWidth:"20rem",minHeight:"20rem",display:"flex",alignItems:"center",justifyContent:"center"},color:"danger",variant:"soft",children:e.jsx(u,{color:"danger",level:"body-lg",children:"Couldn't query Job Results"})}),p&&e.jsx(w,{}),n&&e.jsx(f,{title:"Registered Jobs",Headers:A,Rows:(n==null?void 0:n.jobResults.map((t,c)=>e.jsx(q,{id:t.id,jobId:t.jobId,endpoint:t.endpoint,method:t.httpmethod,succeeded:t.succeeded,lastStatusCode:t.lastStatusCode,lastResponseAt:t.lastResponseAt},c)))||[],Foot:e.jsx(B,{page:a,rowsPerPage:r,handleChangePage:t=>{o(t)},handleChangeRowsPerPage:(t,c)=>{i(parseInt(c.toString(),10))},currentPageLength:(n==null?void 0:n.jobResults)||0})})]})})};export{M as default};
